/******************************************************************************
 * (c) Skatech Research Lab, 2000-2022.
 * Last change: 2022.08.05
 * LCD Nokia1110i driver source file
 *****************************************************************************/

#include <avr/pgmspace.h>
#include "LCD8814.h"

static uint8_t __fontH4[] PROGMEM = {
	//0 12x32,
	0xF0,0xF0,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0xF0,0xF0,
	0x7F,0x7F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0x7F,
	0xFE,0xFE,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0xFE,
	0x0F,0x0F,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x0F,0x0F,
	//1 12x32,
	0x00,0x00,0x00,0x00,0x00,0x00,0xFC,0xFC,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0x7F,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0xFE,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x3F,0x00,0x00,0x00,0x00,
	//2 12x32,
	0x00,0x00,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0xF0,0xF0,
	0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x7F,0x7F,
	0xFE,0xFE,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x00,0x00,
	0x0F,0x0F,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x00,0x00,
	//3 12x32,
	0x00,0x00,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0xF0,0xF0,
	0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x7F,0x7F,
	0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0xFE,0xFE,
	0x00,0x00,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x0F,0x0F,
	//4 12x32,
	0xFC,0xFC,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFC,0xFC,
	0x7F,0x7F,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x7F,0x7F,
	0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0xFE,0xFE,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x3F,
	//5 12x32,
	0xF0,0xF0,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x00,0x00,
	0x7F,0x7F,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x00,0x00,
	0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0xFE,0xFE,
	0x00,0x00,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x0F,0x0F,
	//6 12x32,
	0xF8,0xF8,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x00,0x00,
	0x7F,0x7F,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x00,0x00,
	0xFE,0xFE,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0xFE,0xFE,
	0x0F,0x0F,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x0F,0x0F,
	//7 12x32,
	0x00,0x00,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0xF0,0xF0,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0x7F,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0xFE,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x3F,
	//8 12x32,
	0xF0,0xF0,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0xF0,0xF0,
	0x7F,0x7F,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x7F,0x7F,
	0xFE,0xFE,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0xFE,0xFE,
	0x0F,0x0F,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x0F,0x0F,
	//9 12x32,
	0xF0,0xF0,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0xF0,0xF0,
	0x7F,0x7F,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x7F,0x7F,
	0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0xFE,0xFE,
	0x00,0x00,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x0F,0x0F,
	//A 8x32,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x80,0xC0,0x60,0x60,0xC0,0x80,0x00,
	0xFF,0xFF,0x80,0x80,0x80,0x80,0xFF,0xFF,
	0x3F,0x3F,0x01,0x01,0x01,0x01,0x3F,0x3F,
	//V 8x32,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0xE0,0xE0,0x00,0x00,0x00,0x00,0xE0,0xE0,
	0xFF,0xFF,0x00,0x00,0x00,0x00,0xFF,0xFF,
	0x07,0x0F,0x18,0x30,0x30,0x18,0x0F,0x07,

/*	//As 8x32, 
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x80,0x40,0x20,0x20,0x40,0x80,0x00,
	0xFF,0x80,0x80,0x80,0x80,0x80,0x80,0xFF,
	0x3F,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,
	//Vs 8x32,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0xE0,
	0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,
	0x07,0x08,0x10,0x20,0x20,0x10,0x08,0x07,*/

	//Dot 2x32,
	0x00,0x00,
	0x00,0x00,
	0x00,0x00,
	0x30,0x30,
};

#define __SYMHGT	4

uint8_t LCD_DrawChar14X32(char code, uint8_t xpos, uint8_t ypos) {
	uint16_t offs;
	uint8_t wdth;

	switch (code) {
		case '0':
		case '1':
		case '2':
		case '3':
		case '4':
		case '5':
		case '6':
		case '7':
		case '8':
		case '9':
			wdth = 12;
			offs = 12 * __SYMHGT * (code - '0');
			break;
		case 'A':
			wdth = 8;
			offs = 12 * __SYMHGT * 10 + 8 * __SYMHGT * 0;
			break;
		case 'V':
			wdth = 8;
			offs = 12 * __SYMHGT * 10 + 8 * __SYMHGT * 1;
			break;
		case '.':
			wdth = 2;
			offs = 12 * __SYMHGT * 10 + 8 * __SYMHGT * 2;
			break;
		default:
			return xpos;
	}

  	for (uint8_t b = 0; b < __SYMHGT; b++) {
		LCD_set_position(xpos, ypos + b);
		LCD_send_data(0);
	  	for (uint8_t i = 0; i < wdth; i++) {
			LCD_send_data(pgm_read_byte(&__fontH4[offs + b * wdth + i]));
		}
		LCD_send_data(0);
	}
	return xpos + wdth + 2;
}

void LCD_DrawString14X32(const char* text, uint8_t xpos, uint8_t ypos) {
	for (uint8_t i = 0; text[i]; i++) {
		xpos = LCD_DrawChar14X32(text[i], xpos, ypos);
	}
}
